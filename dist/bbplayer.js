class BB{#PLAY_BTN;#GIF_1;#GIF_2;constructor(t,s=null){this.#PLAY_BTN='<svg id="bb-play-btn" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><path fill="#fff" d="M0 0h50v50H0z"/><path d="m43.301 25-21.65 12.5L0 50V0l21.65 12.5z"/></svg>',this.#GIF_1="https://media.giphy.com/media/1lALzcU4pUHWWMGTlK/giphy.gif",this.#GIF_2="https://i.pinimg.com/originals/fe/ae/ea/feaeea33c22a7a7195e430a9bfe538c5.gif",this._DEBUG=(s=s||{}).debug||!1,this._WRAPPER_SELECTOR=t,this._AUTOPLAY=s.autoplay||!1,this._CONTROLS=s.controls||!1,this._LOADING_IMG_SRC=s.loadingImgSrc||this.#GIF_2,this._LOADING_TEXT=s.loadingText||"loading ..",this._SELECTORS={BBContainer:"#bb-container",BBVideo:"#bb-video",BBLoadingImg:"#bb-loading-img",BBLoadingText:"#bb-loading-text",BBPlayBtnContainer:"#bb-play-btn-container",BBPlayBtn:"#bb-play-btn",BBErrBtn:"#bb-err-btn"},this._currentState=null,this.create(),this.setup(),this.renderState(this.STATES.INITIAL),this.bindEvents()}loadSources(){}setup(){this.STATES={INITIAL:[{selector:this._SELECTORS.BBVideo,classList:["bb-hidden","bb-no-pointer"]},{selector:this._SELECTORS.BBLoadingImg,classList:["bb-hidden"]},{selector:this._SELECTORS.BBLoadingText,classList:["bb-hidden"]},{selector:this._SELECTORS.BBPlayBtn,classList:["bb-hidden"]}],LOADING:[{selector:this._SELECTORS.BBVideo,classList:["bb-no-pointer"]},{selector:this._SELECTORS.BBLoadingImg,classList:[]},{selector:this._SELECTORS.BBLoadingText,classList:[]},{selector:this._SELECTORS.BBPlayBtn,classList:["bb-hidden"]}],READY:[{selector:this._SELECTORS.BBVideo,classList:["bb-no-pointer"]},{selector:this._SELECTORS.BBLoadingImg,classList:["bb-dimmed"]},{selector:this._SELECTORS.BBLoadingText,classList:["bb-hidden"]},{selector:this._SELECTORS.BBPlayBtn,classList:[]}],PLAYING:[{selector:this._SELECTORS.BBLoadingImg,classList:["bb-hidden"]},{selector:this._SELECTORS.BBLoadingText,classList:["bb-hidden"]},{selector:this._SELECTORS.BBPlayBtn,classList:["bb-hidden"]}],PAUSED:[{selector:this._SELECTORS.BBVideo,classList:["bb-no-pointer","bb-dimmed","bb-no-controls"]},{selector:this._SELECTORS.BBLoadingImg,classList:["bb-hidden"]},{selector:this._SELECTORS.BBLoadingText,classList:["bb-hidden"]},{selector:this._SELECTORS.BBPlayBtn,classList:[]}],ERROR:[{selector:this._SELECTORS.BBVideo,classList:["bb-no-pointer"]},{selector:this._SELECTORS.BBLoadingImg,classList:["bb-hidden"]},{selector:this._SELECTORS.BBLoadingText,classList:["bb-hidden"]},{selector:this._SELECTORS.BBPlayBtn,classList:["bb-hidden"]}]}}loadScript(t,s){const i=document.createElement("script");i.type="text/javascript",i.src=t,i.onload=s,document.head.appendChild(i)}forceLoadingAnim(){this.renderState(this.STATES.LOADING)}load(t){if(this.renderState(this.STATES.LOADING),this._DEBUG&&console.log("video loading : "+t),Hls.isSupported()){const s=new Hls;s.loadSource(t),s.attachMedia(this.DOMEl(this._SELECTORS.BBVideo))}else this.DOMEl(this._SELECTORS.BBVideo).canPlayType("application/vnd.apple.mpegurl")&&(this.DOMEl(this._SELECTORS.BBVideo).src=t);this.bindEvents()}play(){this.renderState(this.STATES.PLAYING),this.DOMEl(this._SELECTORS.BBVideo).play()}pause(){this.renderState(this.STATES.PAUSED),this.DOMEl(this._SELECTORS.BBVideo).pause()}renderState(t){if(this._currentState)for(var s of this._currentState){let t=this.DOMEl(s.selector);t.classList.remove(...s.classList)}for(var i of t){let t=this.DOMEl(i.selector);t.classList.add(...i.classList)}this._currentState=t}DOMEl(t){return document.querySelector(t)}setVolume(t){this.DOMEl(this._SELECTORS.BBVideo).volume=t}setLoadingImg(t){this._LOADING_IMG_SRC=t,this.DOMEl(this._SELECTORS.BBLoadingImg).src=t}create(){var t=`    <div id="bb-container">
      <video id="bb-video" ${this._CONTROLS?"controls":""} ${this._AUTOPLAY?"autoplay":""}></video>
      <img id="bb-loading-img" src="${this._LOADING_IMG_SRC}">
      <span id="bb-loading-text">${this._LOADING_TEXT}</span>
      <div id="bb-play-btn-container">
        ${this.#PLAY_BTN}
      </div>
    </div>
    `;this.DOMEl(this._WRAPPER_SELECTOR).insertAdjacentHTML("beforeend",t),this.DOMEl(this._SELECTORS.BBLoadingText).style.transform=randomTranslate()}bindEvents(){let t,s;s="listenerLoadedData",t=this.DOMEl(this._SELECTORS.BBVideo),s in t.dataset||(t.addEventListener("loadeddata",()=>{this._DEBUG&&console.log("video loaded"),this.renderState(this.STATES.READY)}),t.dataset[s]=""),s="listenerPauseFired",t=this.DOMEl(this._SELECTORS.BBVideo),s in t.dataset||(t.addEventListener("pause",t=>{4===this.DOMEl(this._SELECTORS.BBVideo).readyState&&(t.preventDefault(),this._DEBUG&&console.log("video paused"),this.pause())}),t.dataset[s]=""),s="listenerPlayFired",t=this.DOMEl(this._SELECTORS.BBVideo),s in t.dataset||(t.addEventListener("play",t=>{t.preventDefault(),this._DEBUG&&console.log("video playing"),this.play()}),t.dataset[s]=""),s="listenerPlayBtnClicked",t=this.DOMEl(this._SELECTORS.BBPlayBtn),s in t.dataset||t.addEventListener("click",()=>{this.play()}),t.dataset[s]=""}}function randomTranslate(){return`translate(${randomSign()*randomNum(50,100)-50}%, ${randomSign()*randomNum(50,100)-50}%)`}function randomNum(t,s){return t+Math.floor(Math.random()*(s-t))}function randomSign(){return Math.random()<.5?-1:1}